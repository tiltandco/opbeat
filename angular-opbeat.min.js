!function t(e,n,r){function i(a,s){if(!n[a]){if(!e[a]){var c="function"==typeof require&&require;if(!s&&c)return c(a,!0);if(o)return o(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var l=n[a]={exports:{}};e[a][0].call(l.exports,function(t){var n=e[a][1][t];return i(n?n:t)},l,l.exports,t,e,n,r)}return n[a].exports}for(var o="function"==typeof require&&require,a=0;a<r.length;a++)i(r[a]);return i}({1:[function(t,e,n){function r(t){var e=t.split("/");t=e.length>1?["Object",e[e.length-1]].join("."):e[0],t=t.replace(/.<$/gi,".<anonymous>"),t=t.replace(/^Anonymous function$/,"<anonymous>");var e=t.split(".");return t=e.length>1?e[e.length-1]:e[0]}e.exports=function(t){return t.map(function(t){return t.functionName&&(t.functionName=r(t.functionName)),t})}},{}],2:[function(t,e,n){!function(r,i){"use strict";"function"==typeof define&&define.amd?define("error-stack-parser",["stackframe"],i):"object"==typeof n?e.exports=i(t("stackframe")):r.ErrorStackParser=i(r.StackFrame)}(this,function(t){"use strict";var e=/(^|@)\S+\:\d+/,n=/\s+at .*(\S+\:\d+|\(native\))/;return{parse:function(t){if("undefined"!=typeof t.stacktrace||"undefined"!=typeof t["opera#sourceloc"])return this.parseOpera(t);if(t.stack&&t.stack.match(n))return this.parseV8OrIE(t);if(t.stack&&t.stack.match(e))return this.parseFFOrSafari(t);throw new Error("Cannot parse given Error object")},extractLocation:function(t){if(-1===t.indexOf(":"))return[t];var e=t.replace(/[\(\)\s]/g,"").split(":"),n=e.pop(),r=e[e.length-1];if(!isNaN(parseFloat(r))&&isFinite(r)){var i=e.pop();return[e.join(":"),i,n]}return[e.join(":"),n,void 0]},parseV8OrIE:function(e){return e.stack.split("\n").filter(function(t){return!!t.match(n)},this).map(function(e){var n=e.replace(/^\s+/,"").split(/\s+/).slice(1),r=this.extractLocation(n.pop()),i=n[0]?n[0]:void 0;return"Anonymous"===n[0]&&"function"===n[1]&&(i=n.slice(0,2).join(" ")),new t(i,void 0,r[0],r[1],r[2],e)},this)},parseFFOrSafari:function(n){return n.stack.split("\n").filter(function(t){return!!t.match(e)},this).map(function(e){var n=e.split("@"),r=this.extractLocation(n.pop()),i=n.shift()||void 0;return new t(i,void 0,r[0],r[1],r[2],e)},this)},parseOpera:function(t){return!t.stacktrace||t.message.indexOf("\n")>-1&&t.message.split("\n").length>t.stacktrace.split("\n").length?this.parseOpera9(t):t.stack?this.parseOpera11(t):this.parseOpera10(t)},parseOpera9:function(e){for(var n=/Line (\d+).*script (?:in )?(\S+)/i,r=e.message.split("\n"),i=[],o=2,a=r.length;a>o;o+=2){var s=n.exec(r[o]);s&&i.push(new t(void 0,void 0,s[2],s[1],void 0,r[o]))}return i},parseOpera10:function(e){for(var n=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i,r=e.stacktrace.split("\n"),i=[],o=0,a=r.length;a>o;o+=2){var s=n.exec(r[o]);s&&i.push(new t(s[3]||void 0,void 0,s[2],s[1],void 0,r[o]))}return i},parseOpera11:function(n){return n.stack.split("\n").filter(function(t){return!!t.match(e)&&!t.match(/^Error created at/)},this).map(function(e){var n,r=e.split("@"),i=this.extractLocation(r.pop()),o=r.shift()||"",a=o.replace(/<anonymous function(: (\w+))?>/,"$2").replace(/\([^\)]*\)/g,"")||void 0;o.match(/\(([^\)]*)\)/)&&(n=o.replace(/^[^\(]+\(([^\)]*)\)$/,"$1"));var s=void 0===n||"[arguments not available]"===n?void 0:n.split(",");return new t(a,s,i[0],i[1],i[2],e)},this)}}})},{stackframe:8}],3:[function(t,e,n){(function(n,r){(function(){"use strict";function i(t){return"function"==typeof t||"object"==typeof t&&null!==t}function o(t){return"function"==typeof t}function a(t){return"object"==typeof t&&null!==t}function s(t){V=t}function c(t){Y=t}function u(){return function(){n.nextTick(g)}}function l(){return function(){z(g)}}function f(){var t=0,e=new Q(g),n=document.createTextNode("");return e.observe(n,{characterData:!0}),function(){n.data=t=++t%2}}function p(){var t=new MessageChannel;return t.port1.onmessage=g,function(){t.port2.postMessage(0)}}function h(){return function(){setTimeout(g,1)}}function g(){for(var t=0;J>t;t+=2){var e=et[t],n=et[t+1];e(n),et[t]=void 0,et[t+1]=void 0}J=0}function d(){try{var e=t,n=e("vertx");return z=n.runOnLoop||n.runOnContext,l()}catch(r){return h()}}function m(){}function v(){return new TypeError("You cannot resolve a promise with itself")}function b(){return new TypeError("A promises callback cannot return that same promise.")}function y(t){try{return t.then}catch(e){return ot.error=e,ot}}function _(t,e,n,r){try{t.call(e,n,r)}catch(i){return i}}function w(t,e,n){Y(function(t){var r=!1,i=_(n,e,function(n){r||(r=!0,e!==n?T(t,n):$(t,n))},function(e){r||(r=!0,F(t,e))},"Settle: "+(t._label||" unknown promise"));!r&&i&&(r=!0,F(t,i))},t)}function x(t,e){e._state===rt?$(t,e._result):e._state===it?F(t,e._result):O(e,void 0,function(e){T(t,e)},function(e){F(t,e)})}function S(t,e){if(e.constructor===t.constructor)x(t,e);else{var n=y(e);n===ot?F(t,ot.error):void 0===n?$(t,e):o(n)?w(t,e,n):$(t,e)}}function T(t,e){t===e?F(t,v()):i(e)?S(t,e):$(t,e)}function k(t){t._onerror&&t._onerror(t._result),N(t)}function $(t,e){t._state===nt&&(t._result=e,t._state=rt,0!==t._subscribers.length&&Y(N,t))}function F(t,e){t._state===nt&&(t._state=it,t._result=e,Y(k,t))}function O(t,e,n,r){var i=t._subscribers,o=i.length;t._onerror=null,i[o]=e,i[o+rt]=n,i[o+it]=r,0===o&&t._state&&Y(N,t)}function N(t){var e=t._subscribers,n=t._state;if(0!==e.length){for(var r,i,o=t._result,a=0;a<e.length;a+=3)r=e[a],i=e[a+n],r?A(n,r,i,o):i(o);t._subscribers.length=0}}function j(){this.error=null}function E(t,e){try{return t(e)}catch(n){return at.error=n,at}}function A(t,e,n,r){var i,a,s,c,u=o(n);if(u){if(i=E(n,r),i===at?(c=!0,a=i.error,i=null):s=!0,e===i)return void F(e,b())}else i=r,s=!0;e._state!==nt||(u&&s?T(e,i):c?F(e,a):t===rt?$(e,i):t===it&&F(e,i))}function C(t,e){try{e(function(e){T(t,e)},function(e){F(t,e)})}catch(n){F(t,n)}}function I(t,e){var n=this;n._instanceConstructor=t,n.promise=new t(m),n._validateInput(e)?(n._input=e,n.length=e.length,n._remaining=e.length,n._init(),0===n.length?$(n.promise,n._result):(n.length=n.length||0,n._enumerate(),0===n._remaining&&$(n.promise,n._result))):F(n.promise,n._validationError())}function B(t){return new st(this,t).promise}function R(t){function e(t){T(i,t)}function n(t){F(i,t)}var r=this,i=new r(m);if(!G(t))return F(i,new TypeError("You must pass an array to race.")),i;for(var o=t.length,a=0;i._state===nt&&o>a;a++)O(r.resolve(t[a]),void 0,e,n);return i}function M(t){var e=this;if(t&&"object"==typeof t&&t.constructor===e)return t;var n=new e(m);return T(n,t),n}function P(t){var e=this,n=new e(m);return F(n,t),n}function L(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function U(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function D(t){this._id=pt++,this._state=void 0,this._result=void 0,this._subscribers=[],m!==t&&(o(t)||L(),this instanceof D||U(),C(this,t))}function q(){var t;if("undefined"!=typeof r)t=r;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var n=t.Promise;(!n||"[object Promise]"!==Object.prototype.toString.call(n.resolve())||n.cast)&&(t.Promise=ht)}var H;H=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)};var z,V,W,G=H,J=0,Y=({}.toString,function(t,e){et[J]=t,et[J+1]=e,J+=2,2===J&&(V?V(g):W())}),K="undefined"!=typeof window?window:void 0,X=K||{},Q=X.MutationObserver||X.WebKitMutationObserver,Z="undefined"!=typeof n&&"[object process]"==={}.toString.call(n),tt="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,et=new Array(1e3);W=Z?u():Q?f():tt?p():void 0===K&&"function"==typeof t?d():h();var nt=void 0,rt=1,it=2,ot=new j,at=new j;I.prototype._validateInput=function(t){return G(t)},I.prototype._validationError=function(){return new Error("Array Methods must be provided an Array")},I.prototype._init=function(){this._result=new Array(this.length)};var st=I;I.prototype._enumerate=function(){for(var t=this,e=t.length,n=t.promise,r=t._input,i=0;n._state===nt&&e>i;i++)t._eachEntry(r[i],i)},I.prototype._eachEntry=function(t,e){var n=this,r=n._instanceConstructor;a(t)?t.constructor===r&&t._state!==nt?(t._onerror=null,n._settledAt(t._state,e,t._result)):n._willSettleAt(r.resolve(t),e):(n._remaining--,n._result[e]=t)},I.prototype._settledAt=function(t,e,n){var r=this,i=r.promise;i._state===nt&&(r._remaining--,t===it?F(i,n):r._result[e]=n),0===r._remaining&&$(i,r._result)},I.prototype._willSettleAt=function(t,e){var n=this;O(t,void 0,function(t){n._settledAt(rt,e,t)},function(t){n._settledAt(it,e,t)})};var ct=B,ut=R,lt=M,ft=P,pt=0,ht=D;D.all=ct,D.race=ut,D.resolve=lt,D.reject=ft,D._setScheduler=s,D._setAsap=c,D._asap=Y,D.prototype={constructor:D,then:function(t,e){var n=this,r=n._state;if(r===rt&&!t||r===it&&!e)return this;var i=new this.constructor(m),o=n._result;if(r){var a=arguments[r-1];Y(function(){A(r,i,a,o)})}else O(n,i,t,e);return i},"catch":function(t){return this.then(null,t)}};var gt=q,dt={Promise:ht,polyfill:gt};"function"==typeof define&&define.amd?define(function(){return dt}):"undefined"!=typeof e&&e.exports?e.exports=dt:"undefined"!=typeof this&&(this.ES6Promise=dt),gt()}).call(this)}).call(this,t("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:4}],4:[function(t,e,n){function r(){l=!1,s.length?u=s.concat(u):f=-1,u.length&&i()}function i(){if(!l){var t=setTimeout(r);l=!0;for(var e=u.length;e;){for(s=u,u=[];++f<e;)s&&s[f].run();f=-1,e=u.length}s=null,l=!1,clearTimeout(t)}}function o(t,e){this.fun=t,this.array=e}function a(){}var s,c=e.exports={},u=[],l=!1,f=-1;c.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];u.push(new o(t,e)),1!==u.length||l||setTimeout(i,0)},o.prototype.run=function(){this.fun.apply(null,this.array)},c.title="browser",c.browser=!0,c.env={},c.argv=[],c.version="",c.versions={},c.on=a,c.addListener=a,c.once=a,c.off=a,c.removeListener=a,c.removeAllListeners=a,c.emit=a,c.binding=function(t){throw new Error("process.binding is not supported")},c.cwd=function(){return"/"},c.chdir=function(t){throw new Error("process.chdir is not supported")},c.umask=function(){return 0}},{}],5:[function(t,e,n){e.exports=t("./lib/simple_lru.js")},{"./lib/simple_lru.js":6}],6:[function(t,e,n){"use strict";function r(t,e,n,r){this.before=t,this.next=e,this.key=n,this.value=r}function i(t){t||(t={}),this.maxSize=t.maxSize,this.reset()}r.prototype.setKey=function(t){this.key=t},r.prototype.setValue=function(t){this.value=t},i.prototype.reset=function(){this.size=0,this.cache={},this.tail=void 0,this.head=void 0},i.prototype.get=function(t,e){var n=this.cache[t];return e=void 0!=e&&null!=e?e:!0,n&&e?(this.hit(n),n.value):void 0},i.prototype.set=function(t,e,n){var i=this.cache[t];if(n=void 0!=n&&null!=n?n:!0,i)i.value=e,n&&this.hit(i);else{var o;if(this.size>=this.maxSize){var a=this.tail.key;this.detach(this.tail),o=this.cache[a],delete this.cache[a],o.next=void 0,o.before=void 0,o.setKey(t),o.setValue(e)}o=o?o:new r(void 0,void 0,t,e),this.cache[t]=o,this.attach(o)}},i.prototype.del=function(t){var e=this.cache[t];e&&(this.detach(e),delete this.cache[t])},i.prototype.hit=function(t){this.detach(t),this.attach(t)},i.prototype.attach=function(t){t&&(t.before=void 0,t.next=this.head,this.head=t,t.next?t.next.before=t:this.tail=t,this.size++)},i.prototype.detach=function(t){if(t){var e=t.before,n=t.next;e?e.next=n:this.head=n,n?n.before=e:this.tail=e,this.size--}},i.prototype.forEach=function(t){var e=this;Object.keys(this.cache).forEach(function(n){var r=e.cache[n];t(r.value,n)})},e.exports=i},{}],7:[function(t,e,n){!function(r,i){"use strict";"function"==typeof define&&define.amd?define("stack-generator",["stackframe"],i):"object"==typeof n?e.exports=i(t("stackframe")):r.StackGenerator=i(r.StackFrame)}(this,function(t){return{backtrace:function(e){var n=[],r=10;"object"==typeof e&&"number"==typeof e.maxStackSize&&(r=e.maxStackSize);for(var i=arguments.callee;i&&n.length<r;){for(var o=new Array(i.arguments.length),a=0;a<o.length;++a)o[a]=i.arguments[a];/function(?:\s+([\w$]+))+\s*\(/.test(i.toString())?n.push(new t(RegExp.$1||void 0,o)):n.push(new t(void 0,o));try{i=i.caller}catch(s){break}}return n}}})},{stackframe:8}],8:[function(t,e,n){!function(t,r){"use strict";"function"==typeof define&&define.amd?define("stackframe",[],r):"object"==typeof n?e.exports=r():t.StackFrame=r()}(this,function(){"use strict";function t(t){return!isNaN(parseFloat(t))&&isFinite(t)}function e(t,e,n,r,i,o){void 0!==t&&this.setFunctionName(t),void 0!==e&&this.setArgs(e),void 0!==n&&this.setFileName(n),void 0!==r&&this.setLineNumber(r),void 0!==i&&this.setColumnNumber(i),void 0!==o&&this.setSource(o)}return e.prototype={getFunctionName:function(){return this.functionName},setFunctionName:function(t){this.functionName=String(t)},getArgs:function(){return this.args},setArgs:function(t){if("[object Array]"!==Object.prototype.toString.call(t))throw new TypeError("Args must be an Array");this.args=t},getFileName:function(){return this.fileName},setFileName:function(t){this.fileName=String(t)},getLineNumber:function(){return this.lineNumber},setLineNumber:function(e){if(!t(e))throw new TypeError("Line Number must be a Number");this.lineNumber=Number(e)},getColumnNumber:function(){return this.columnNumber},setColumnNumber:function(e){if(!t(e))throw new TypeError("Column Number must be a Number");this.columnNumber=Number(e)},getSource:function(){return this.source},setSource:function(t){this.source=String(t)},toString:function(){var e=this.getFunctionName()||"{anonymous}",n="("+(this.getArgs()||[]).join(",")+")",r=this.getFileName()?"@"+this.getFileName():"",i=t(this.getLineNumber())?":"+this.getLineNumber():"",o=t(this.getColumnNumber())?":"+this.getColumnNumber():"";return e+n+r+i+o}},e})},{}],9:[function(t,e,n){function r(){this.config=function(t){a.config(t)},this.install=function(){a.install()},this.version="v1.1.7",this.$get=[function(){return{getConfig:function(){return a.config()},captureException:function(t,e){a.captureException(t,e)},setUserContext:function(t){a.setUserContext(t)},setExtraContext:function(t){a.setExtraContext(t)}}}]}function i(t){t.decorator("$exceptionHandler",["$delegate","$opbeat",function(t,e){return function(n,r){return e.captureException(n),t(n,r)}}])}function o(e,n){var r=n.$get[0]().getConfig(),i={config:r},o=new s("beforeControllerTransaction",i);e.decorator("$controller",["$delegate","$location","$rootScope","$injector",function(t,e,n,s){c.init(s);var f=function(t,n){if(l.log("opbeat.decorator.controller.onRouteChange",n),!r.get("isInstalled"))return void l.log("opbeat.instrumentation.onRouteChange.not.installed");var s,u,f;if(n.controller)u=n.controller;else if(n.views){var p=Object.keys(n.views);p&&(u=n.views[p[0]].controller)}if("string"==typeof u&&(s=u),!s)return void l.log("%c opbeat.decorator.controller.onRouteChange.error.routeControllerName.missing","background-color: #ffff00",n);if(n.$$route?f=n.$$route.originalPath:n.url&&(f=n.name),!f)return void l.log("%c opbeat.decorator.controller.onRouteChange.error.transactionName.missing","background-color: #ffff00",n);var h=a.startTransaction(f,"transaction",i);h.metadata.controllerName=s,c.pushToUrl(e.absUrl(),h),o.setTransactionReference(h),o.lock()};return n.$on("$routeChangeStart",f),n.$on("$stateChangeSuccess",f),function(){l.log("opbeat.decorator.controller.ctor");var e=Array.prototype.slice.call(arguments),n=s.get("$location").absUrl(),r=c.getRecentByUrl(n),i=u.getControllerInfoFromArgs(e),o=i.name,a=i.scope,f=o&&r&&r.metadata.controllerName===o,p=t.apply(this,e),h=function(t){l.log("opbeat.angular.controller.$onViewFinished"),c.getAllByUrl(n).forEach(function(t){r.end()}),c.clearByUrl(n)},g=function(){l.log("opbeat.angular.controller.destroy")};return f&&a&&(l.log("opbeat.angular.controller",o),a.$on("$destroy",g),a.$on("$ionicView.enter",h),a.$on("$viewContentLoaded",h)),l.log("opbeat.decorator.controller.end"),p}}]),e.decorator("$controller",["$delegate","$rootScope","$rootElement",function(n,r,i){r._opbeatHasInstrumentedFactories=!1,r._opbeatHasInstrumentedDirectives=!1;var a=t("./instrumentation/angular/directives")(e,o);if(!r._opbeatHasInstrumentedFactories){var s=u.resolveAngularDependenciesByType(i,"factory");t("./instrumentation/angular/factories")(e,o).instrumentAll(s),r._opbeatHasInstrumentedFactories=!0}if(!r._opbeatHasInstrumentedDirectives){var c=u.resolveAngularDependenciesByType(i,"directive");a.instrumentAll(c),r._opbeatHasInstrumentedDirectives=!0,a.instrumentCore()}return n}]),t("./instrumentation/angular/cacheFactory")(e,o),t("./instrumentation/angular/compile")(e,o),t("./instrumentation/angular/controller")(e,o),t("./instrumentation/angular/http")(e,o),t("./instrumentation/angular/httpBackend")(e,o),t("./instrumentation/angular/resource")(e,o),t("./instrumentation/angular/templateRequest")(e,o)}var a=t("./opbeat"),s=t("./instrumentation/traceBuffer"),c=t("./instrumentation/transactionStore"),u=t("./instrumentation/utils"),l=t("./lib/logger");window.angular.module("ngOpbeat",[]).provider("$opbeat",r).config(["$provide","$opbeatProvider",i]).config(["$provide","$opbeatProvider",o]),window.angular.module("angular-opbeat",["ngOpbeat"])},{"./instrumentation/angular/cacheFactory":14,"./instrumentation/angular/compile":15,"./instrumentation/angular/controller":16,"./instrumentation/angular/directives":17,"./instrumentation/angular/factories":18,"./instrumentation/angular/http":19,"./instrumentation/angular/httpBackend":20,"./instrumentation/angular/resource":21,"./instrumentation/angular/templateRequest":22,"./instrumentation/traceBuffer":25,"./instrumentation/transactionStore":28,"./instrumentation/utils":29,"./lib/logger":33,"./opbeat":37}],10:[function(t,e,n){var r=t("es6-promise").Promise,i=t("../lib/utils"),o=t("../lib/fileFetcher");e.exports={getFileSourceMapUrl:function(t){function e(t){var e=/\/\/[#@] ?sourceMappingURL=([^\s'"]+)$/.exec(t);return e&&e[1]?e[1]:null}var n;return t?(n=t.split("/").length>1?t.split("/").slice(0,-1).join("/")+"/":"/",new r(function(r,i){o.getFile(t).then(function(t){var o=e(t);o?(o=n+o,r(o)):i("no sourceMapUrl")},i)})):r.reject("no fileUrl")},getExceptionContexts:function(t,e){return t&&e?new r(function(n,r){o.getFile(t).then(function(t){e-=1;var o=t.split("\n"),a=5,s=5,c={preContext:[],contextLine:null,postContext:[]};if(o.length){var u;if(u=t.indexOf("<html")>-1?!1:this.isSourceMinified(t))return r();for(var l=Math.max(0,e-a-1),f=Math.min(o.length,e-1),p=l;f>=p;++p)i.isUndefined(o[p])||c.preContext.push(o[p]);c.contextLine=o[e];for(var h=Math.min(o.length,e+1),g=Math.min(o.length,e+s),d=h;g>=d;++d)i.isUndefined(o[d])||c.postContext.push(o[d])}var m=1e3;c.contextLine.length>m&&r("aborting generating contexts, as line is over 1000 chars"),c.preContext.forEach(function(t){t.length>m&&r("aborting generating contexts, as preContext line is over 1000 chars")}),c.postContext.forEach(function(t){t.length>m&&r("aborting generating contexts, as postContext line is over 1000 chars")}),n(c)}.bind(this),r)}.bind(this)):r.reject("no line or url")},isSourceMinified:function(t){var e,n=50,r=5,i=250,o=0,a=0,s=0,c=0,u=!1;if(!t)return!1;for(t=t.replace(/\/\*[\S\s]*?\*\/|\/\/(.+|\n)/g,"");s++<n&&(o=t.indexOf("\n",a),-1!==o);){if(/^\s+/.test(t.slice(a,o))&&c++,o-a>i){u=!0;break}a=o+1}return e=r>c/s*100||u}}},{"../lib/fileFetcher":32,"../lib/utils":36,"es6-promise":3}],11:[function(t,e,n){var r=t("es6-promise").Promise,i=t("../lib/logger"),o=t("../lib/config"),a=t("../lib/transport"),s=t("../lib/utils"),c=t("./context"),u=t("./stacktrace"),l=function(t){for(var e=r.resolve(),n=[],i=0;i<t.length;++i)n.push(e=e.then(t[i]));return r.all(n)};e.exports={getFramesForCurrent:function(){return u.get().then(function(t){var e=t.map(function(t){return this.buildOpbeatFrame.bind(this,t)}.bind(this)),n=l(e);return n.then(function(t){return t})}.bind(this))},buildOpbeatFrame:function(t){return new r(function(e,n){if(!t.fileName&&!t.lineNumber)return e({});if(!t.columnNumber&&!t.lineNumber)return e({});var r=this.cleanFilePath(t.fileName),i=this.filePathToFileName(r);this.isFileInline(r)&&(i="(inline script)");var o={filename:i,lineno:t.lineNumber,colno:t.columnNumber,"function":t.functionName||"<anonymous>",abs_path:t.fileName,in_app:this.isFileInApp(r)},a=c.getFileSourceMapUrl(r);a.then(function(t){o.sourcemap_url=t,e(o)},function(){var n=this.cleanFilePath(t.fileName),r=c.getExceptionContexts(n,t.lineNumber);r.then(function(t){o.pre_context=t.preContext,o.context_line=t.contextLine,o.post_context=t.postContext,e(o)})["catch"](function(){e(o)})}.bind(this))}.bind(this))},stackInfoToOpbeatException:function(t){return new r(function(e,n){if(t.stack&&t.stack.length){var r=t.stack.map(function(t){return this.buildOpbeatFrame.bind(this,t)}.bind(this)),i=l(r);i.then(function(n){t.frames=n,t.stack=null,e(t)})}else e(t)}.bind(this))},processOpbeatException:function(t){var e,n=t.type,r=String(t.message)||"Script error",c=this.cleanFilePath(t.fileurl),u=this.filePathToFileName(c),l=t.frames||[];l&&l.length?l.reverse():u&&l.push({filename:u,lineno:t.lineno});var f={frames:l};if(!u&&l.length){var p=l[l.length-1];u=p.filename?p.filename:"(inline script)"}e=this.isFileInline(c)?"(inline script)":u;var h={message:n+": "+r,culprit:e,exception:{type:n,value:r},http:{url:window.location.href},stacktrace:f,user:o.get("context.user"),level:null,logger:null,machine:null};h.extra=this.getBrowserSpecificMetadata(),o.get("context.extra")&&(h.extra=s.mergeObject(h.extra,o.get("context.extra"))),i.log("opbeat.exceptions.processOpbeatException",h),a.sendError(h)},cleanFilePath:function(t){return t||(t=""),"<anonymous>"===t&&(t=""),t},filePathToFileName:function(t){var e=window.location.origin||window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"");return t.indexOf(e)>-1&&(t=t.replace(e+"/","")),t},isFileInline:function(t){return t?0===window.location.href.indexOf(t):!1},isFileInApp:function(t){var e=o.get("libraryPathPattern");return!RegExp(e).test(t)},getBrowserSpecificMetadata:function(){var t=s.getViewPortInfo(),e={environment:{utcOffset:(new Date).getTimezoneOffset()/-60,browserWidth:t.width,browserHeight:t.height,screenWidth:window.screen.width,screenHeight:window.screen.height,language:navigator.language,userAgent:navigator.userAgent,platform:navigator.platform},page:{referer:document.referrer,host:document.domain,location:window.location.href}};return e}}},{"../lib/config":31,"../lib/logger":33,"../lib/transport":35,"../lib/utils":36,"./context":10,"./stacktrace":13,"es6-promise":3}],12:[function(t,e,n){function r(t,e,n,r,s){if("Script error."!==e||n){var c={message:t?t.message:e,type:t?t.name:null,fileurl:n||null,lineno:r||null,colno:s||null};c.type||c.message.indexOf(":")>-1&&(c.type=c.message.split(":")[0]);var u;u=t?o.fromError(t):new i(function(t,e){t([{fileName:n,lineNumber:r,columnNumber:s}])}),u.then(function(t){return c.stack=t||[],a.stackInfoToOpbeatException(c).then(function(t){a.processOpbeatException(t)})})["catch"](function(){})}}var i=t("es6-promise").Promise,o=t("./stacktrace"),a=t("./frames"),s=function(){};s.prototype.install=function(){window.onerror=function(t,e,n,i,o){r.call(this,o,t,e,n,i)}.bind(this)},s.prototype.uninstall=function(){window.onerror=null},s.prototype.processError=function(t){r(t)},e.exports=s},{"./frames":11,"./stacktrace":13,"es6-promise":3}],13:[function(t,e,n){function r(t){return t.stack||t["opera#sourceloc"]}var i=t("error-stack-parser"),o=t("stack-generator"),a=t("es6-promise").Promise,s=t("../lib/utils"),c=t("error-stack-normalizer"),u={filter:function(t){return-1===(t.functionName||"").indexOf("StackTrace$$")&&-1===(t.functionName||"").indexOf("ErrorStackParser$$")&&-1===(t.functionName||"").indexOf("StackGenerator$$")&&-1===(t.functionName||"").indexOf("opbeatFunctionWrapper")&&-1===(t.fileName||"").indexOf("angular-opbeat.js")&&-1===(t.fileName||"").indexOf("angular-opbeat.min.js")&&-1===(t.fileName||"").indexOf("opbeat.js")&&-1===(t.fileName||"").indexOf("opbeat.min.js")}};e.exports={get:function(t){try{throw new Error}catch(e){return r(e)?this.fromError(e,t):this.generateArtificially(t)}},generateArtificially:function(t){t=s.mergeObject(u,t);var e=o.backtrace(t);return"function"==typeof t.filter&&(e=e.filter(t.filter)),e=c(e),a.resolve(e)},fromError:function(t,e){return e=s.mergeObject(u,e),new a(function(n){var r=i.parse(t);"function"==typeof e.filter&&(r=r.filter(e.filter)),r=c(r),n(a.all(r.map(function(t){return new a(function(e){e(t)})})))})}}},{"../lib/utils":36,"error-stack-normalizer":1,"error-stack-parser":2,"es6-promise":3,"stack-generator":7}],14:[function(t,e,n){var r=t("../utils");e.exports=function(t,e){t.decorator("$cacheFactory",["$delegate","$injector",function(t,n){return r.instrumentModule(t,n,{traceBuffer:e,prefix:function(t){return t.length?t[0]+"Cache":"cacheFactory"},type:function(){return"cache."+this.prefix},signatureFormatter:function(t,e,n){return["$"+n.prefix,t.toUpperCase(),e[0]].join(" ")}})}])}},{"../utils":29}],15:[function(t,e,n){var r=t("../utils");e.exports=function(t,e){t.decorator("$compile",["$delegate","$injector",function(t,n){return r.instrumentModule(t,n,{type:"template.$compile",prefix:"$compile",traceBuffer:e})}])}},{"../utils":29}],16:[function(t,e,n){var r=t("../utils");t("../transactionStore");e.exports=function(t,e){t.decorator("$controller",["$delegate","$injector",function(t,n){return function(){var i=Array.prototype.slice.call(arguments),o=r.getControllerInfoFromArgs(i);return o.name?r.instrumentModule(t,n,{traceBuffer:e,type:"app.$controller",prefix:"$controller."+o.name}).apply(this,arguments):t.apply(this,i)}}])}},{"../transactionStore":28,"../utils":29}],17:[function(t,e,n){var r=t("../utils");e.exports=function(t,e){var n=function(n){var i=n+"Directive";t.decorator(i,["$delegate","$injector",function(t,i){return r.instrumentObject(t[0],i,{type:"template.$directive",prefix:"$directive."+n,traceBuffer:e}),t}])};return{instrumentAll:function(t){t.forEach(function(t){n(t)})},instrumentCore:function(){var t=["ngBind","ngClass","ngModel","ngIf","ngInclude","ngRepeat","ngSrc","ngStyle","ngSwitch","ngTransclude"];t.forEach(function(t){n(t)})}}}},{"../utils":29}],18:[function(t,e,n){var r=t("../utils");e.exports=function(t,e){return{instrumentAll:function(n){n.forEach(function(n){t.decorator(n,["$delegate","$injector",function(t,i){return r.instrumentObject(t,i,{type:"app.$factory",prefix:"$factory."+n,traceBuffer:e}),t}])})}}}},{"../utils":29}],19:[function(t,e,n){var r=t("../utils");e.exports=function(t,e){t.decorator("$http",["$delegate","$injector",function(t,n){return r.instrumentModule(t,n,{type:"ext.$http",prefix:"$http",traceBuffer:e,signatureFormatter:function(t,e){var n=[];return e.length&&("object"==typeof e[0]?(e[0].method||(e[0].method="get"),n=["$http",e[0].method.toUpperCase(),e[0].url]):n=["$http",e[0]]),n.join(" ")}})}])}},{"../utils":29}],20:[function(t,e,n){var r=t("../utils"),i=t("../transactionStore");e.exports=function(t,e){t.decorator("$httpBackend",["$delegate","$injector",function(t,n){return function(){var o=Array.prototype.slice.call(arguments),a=i.getRecentByUrl(n.get("$location").absUrl()),s=r.instrumentMethodWithCallback(t,"$httpBackend",a,"ext.$httpBackend",{prefix:"$httpBackend",callbackIndex:3,traceBuffer:e,signatureFormatter:function(t,e){var n=["$httpBackend",e[0].toUpperCase(),e[1]];return n.join(" ")}}).apply(this,o);return s}}])}},{"../transactionStore":28,"../utils":29}],21:[function(t,e,n){var r=t("../utils");e.exports=function(t,e){try{t.decorator("$resource",["$delegate","$injector",function(t,n){return r.instrumentModule(t,n,{traceBuffer:e,prefix:"$resource",type:"ext.$resource",signatureFormatter:function(t,e){return["$resource",t.toUpperCase(),e[0]].join(" ")}})}])}catch(n){}}},{"../utils":29}],22:[function(t,e,n){var r=t("../utils");e.exports=function(t,e){try{t.decorator("$templateRequest",["$delegate","$injector",function(t,n){return r.instrumentModule(t,n,{type:"template.$templateRequest",prefix:"$templateRequest",traceBuffer:e,signatureFormatter:function(t,e){var n=["$templateRequest",e[0]];return n.join(" ")}})}])}catch(n){}}},{"../utils":29}],23:[function(t,e,n){function r(t){var e=a(t,c);return Object.keys(e).map(function(t){var n=e[t][0],r=e[t].map(function(t){return t.duration()});return{transaction:n.name,result:n.result,kind:n.type,timestamp:s(n._startStamp).toISOString(),durations:r}})}function i(t,e){var n=function(t,e){var n=0,r=u(e);return t.forEach(function(t,e){t._group===r&&(n=e)}),n},r=a(t,function(t){return t.transaction.name+"|"+t.transaction._start});return Object.keys(r).map(function(t){var i=r[t],o=i[0].transaction,a=[o.duration()];return i.forEach(function(t){var r=n(e,t),i=t._start-o._start;i>o.duration()?p.log("%c -- opbeat.instrumentation.getRawGroupedTracesTimings.error.relativeTraceStartLargerThanTransactionDuration","color: #ff0000",i,o._start,o.duration(),{trace:t,transaction:o}):0>i?p.log("%c -- opbeat.instrumentation.getRawGroupedTracesTimings.error.negativeRelativeTraceStart!","color: #ff0000",i,t._start,o._start,t):t.duration()>o.duration()?p.log("%c -- opbeat.instrumentation.getRawGroupedTracesTimings.error.traceDurationLargerThanTranscationDuration","color: #ff0000",t.duration(),o.duration(),{trace:t,transaction:o}):a.push([r,i,t.duration()])}),a})}function o(t){var e=a(t,u);return Object.keys(e).map(function(t){var n=e[t][0],r=n._start;return n.transaction?r-=n.transaction._start:r=0,{transaction:n.transaction.name,signature:n.signature,kind:n.type,timestamp:n._startStamp.toISOString(),parents:n.ancestors(),extra:{_frames:n.frames},_group:t}}).sort(function(t,e){return t.start_time-e.start_time})}function a(t,e){var n={};return t.forEach(function(t){var r=e(t);r in n?n[r].push(t):n[r]=[t],t._traceGroup=r}),n}function s(t){return new Date(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes())}function c(t){return[s(t._startStamp).getTime(),t.name,t.result,t.type].join("-")}function u(t){var e=t.ancestors().map(function(t){return t.signature}).join(",");return[s(t._startStamp).getTime(),t.transaction.name,e,t.signature,t.type].join("-")}var l=t("./transaction"),f=t("../lib/transport"),p=t("../lib/logger"),h=function(){this._queue=[],this.scheduler=setInterval(this._dispatch.bind(this),5e3)};h.prototype.add=function(t){this._queue.push(t)},h.prototype.startTransaction=function(t,e,n){return new l(this,t,e,n)},h.prototype._flush=function(){this._queue=[]},h.prototype._dispatch=function(){if(p.log("Instrumentation.scheduler._dispatch",this._queue.length),this._queue.length){var t=this._formatTransactions(),e=this._flush.bind(this);f.sendTransaction(t).then(e,e)}},h.prototype._formatTransactions=function(){var t=r(this._queue),e=[].concat.apply([],this._queue.map(function(t){return t.traces})),n=o(e),a=i(e,n);return{transactions:t,traces:{groups:n,raw:a}}},e.exports=h},{"../lib/logger":33,"../lib/transport":35,"./transaction":27}],24:[function(t,e,n){var r=t("es6-promise").Promise,i=t("../lib/logger"),o=t("../exceptions/frames"),a=t("./traceCache"),s=e.exports=function(t,e,n,o){this.transaction=t,this.signature=e,this.type=n,this.ended=!1,this._parent=null,this._start=window.performance.now(),this._startStamp=new Date,this._isFinish=new r(function(t,e){this._markFinishedFunc=t}.bind(this));var a=o.config.get("performance.enableStackFrames");i.log("%c -- opbeat.instrumentation.trace.shouldGenerateStackFrames","color: #9a6bcb",this.signature,a),a?this.getTraceStackFrames(function(t){t&&(this.frames=t.reverse()),this._markFinishedFunc()}.bind(this)):this._markFinishedFunc(),i.log("%c -- opbeat.instrumentation.trace.start","color: #9a6bcb",this.signature,this._start);
};s.prototype.end=function(){this._end=window.performance.now(),this._diff=this._end-this._start,this.ended=!0,i.log("%c -- opbeat.instrumentation.trace.end","color: #9a6bcb",this.signature,this._end,this._diff),this._isFinish.then(function(){this.transaction._onTraceEnd(this)}.bind(this))},s.prototype.duration=function(){return this.ended?parseFloat(this._diff):(i.log("%c -- opbeat.instrumentation.trace.duration.error.un-ended.trace!","color: #ff0000",this.signature,this._diff),null)},s.prototype.startTime=function(){return this.ended&&this.transaction.ended?this._start:(i.log("%c -- opbeat.instrumentation.trace.startTime.error.un-ended.trace!","color: #ff0000",this.signature,this._diff),null)},s.prototype.ancestors=function(){var t=this.parent();return t?[t.signature]:[]},s.prototype.parent=function(){return this._parent},s.prototype.setParent=function(t){this._parent=t},s.prototype.getFingerprint=function(){for(var t=[this.transaction.name,this.signature,this.type],e=this._parent;e;)t.push(e.signature),e=e._parent;return t.join("-")},s.prototype.getTraceStackFrames=function(t){var e=this.getFingerprint(),n=a.get(e);n?t(n):o.getFramesForCurrent().then(function(n){a.set(e,n),t(n)})["catch"](function(){t(null)})},e.exports=s},{"../exceptions/frames":11,"../lib/logger":33,"./traceCache":26,"es6-promise":3}],25:[function(t,e,n){var r=t("../lib/logger"),i=t("./trace"),o=function(t,e){this.traces=[],this.activetraces=[],this.traceTransactionReference=this,this._isLocked=!1,this._options=e};o.prototype.startTrace=function(t,e){r.log("opbeat.instrumentation.TraceBuffer.startTrace",t);var n=new i(this.traceTransactionReference,t,e,this._options);return this._isLocked&&n.setParent(this.traceTransactionReference._rootTrace),this.activetraces.push(n),n},o.prototype._onTraceEnd=function(t){r.log("opbeat.instrumentation.TraceBuffer._endTrace",t.signature),this.traces.push(t);var e=this.activetraces.indexOf(t);e>-1&&this.activetraces.splice(e,1)},o.prototype.setTransactionReference=function(t){r.log("opbeat.instrumentation.TraceBuffer.setTransactionReference",t),this._isLocked||(this.traceTransactionReference=t,this.activetraces.forEach(function(t){t.transaction=this.traceTransactionReference,t.setParent(this.traceTransactionReference._rootTrace)}.bind(this)),this.traces.forEach(function(t){t.transaction=this.traceTransactionReference,t.setParent(this.traceTransactionReference._rootTrace)}.bind(this)),this.traces=[])},o.prototype.lock=function(){this._isLocked=!0},o.prototype.isLocked=function(){return this._isLocked},e.exports=o},{"../lib/logger":33,"./trace":24}],26:[function(t,e,n){var r=t("simple-lru-cache");e.exports=new r({maxSize:5e3})},{"simple-lru-cache":5}],27:[function(t,e,n){function r(t){var e=null;return t.forEach(function(t){e||(e=t),e&&e.duration()<t.duration()&&(e=t)}),e}function i(t){var e=null;return t.forEach(function(t){e||(e=t),e&&e._start>t._start&&(e=t)}),e}var o=t("../lib/logger"),a=t("./trace"),s=function(t,e,n,r){this.metadata={},this.name=e,this.type=n,this.ended=!1,this._markDoneAfterLastTrace=!1,this._isDone=!1,this._options=r,this.traces=[],this._activeTraces={},this._queue=t,o.log("- %c opbeat.instrumentation.transaction.ctor","color: #3360A3",this.name),this._rootTrace=this.startTrace("transaction","transaction",this._options),this._startStamp=this._rootTrace._startStamp,this._start=this._rootTrace._start,this.duration=this._rootTrace.duration.bind(this._rootTrace)};s.prototype.end=function(){this.ended||(this.ended=!0,this._rootTrace.end(),o.log("- %c opbeat.instrumentation.transaction.end","color: #3360A3",this.name,Object.keys(this._activeTraces).length),Object.keys(this._activeTraces).length>0?this._markDoneAfterLastTrace=!0:this._markAsDone())},s.prototype._markAsDone=function(){if(o.log("- %c opbeat.instrumentation.transaction._markAsDone","color: #3360A3",this.name),!this._isDone){this._isDone=!0;var t=this.traces.map(function(t){return t._isFinish});Promise.all(t).then(function(){o.log("- %c opbeat.instrumentation.transaction.whenAllTracesFinished","color: #3360A3",this.name),this._adjustStartToEarliestTrace(),this._adjustDurationToLongestTrace(),this._queue.add(this)}.bind(this))}},s.prototype._adjustStartToEarliestTrace=function(){var t=i(this.traces);t&&(this._start=t._start,this._startStamp=t._startStamp)},s.prototype._adjustDurationToLongestTrace=function(){var t=r(this.traces);if(t){var e=this._rootTrace._diff,n=t.duration();n>e&&(this._rootTrace._diff=n)}},s.prototype.startTrace=function(t,e){var n=new a(this,t,e,this._options);return n.setParent(this._rootTrace),this._activeTraces[n.getFingerprint()]=n,o.log("- %c  opbeat.instrumentation.transaction.startTrace","color: #3360A3",n.signature),n},s.prototype._onTraceEnd=function(t){this.traces.push(t),o.log("- %c  opbeat.instrumentation.transaction._endTrace","color: #3360A3",t.signature),delete this._activeTraces[t.getFingerprint()],this._markDoneAfterLastTrace&&0===Object.keys(this._activeTraces).length&&this._markAsDone()},e.exports=s},{"../lib/logger":33,"./trace":24}],28:[function(t,e,n){var r=t("../lib/logger"),i=function(){};i.prototype.init=function(t){this.$rootScope=t.get("$rootScope"),this.$rootScope._opbeatTransactionStore={}},i.prototype.pushToUrl=function(t,e){var n=this.$rootScope._opbeatTransactionStore[t]||[];n.push(e),r.log("opbeat.instrumentation.TransactionStore.pushToUrl",t,e),this.$rootScope._opbeatTransactionStore[t]=n},i.prototype.getAllByUrl=function(t){return r.log("opbeat.instrumentation.TransactionStore.pushToUrl",t,this.$rootScope),this.$rootScope?this.$rootScope._opbeatTransactionStore[t]||[]:[]},i.prototype.getRecentByUrl=function(t){var e;return this.$rootScope&&(e=this.$rootScope._opbeatTransactionStore[t]),r.log("opbeat.instrumentation.TransactionStore.getRecentByUrl",t,e),e&&e.length?e.slice(-1)[0]:null},i.prototype.clearByUrl=function(t){this.$rootScope._opbeatTransactionStore[t]=[]},e.exports=new i},{"../lib/logger":33}],29:[function(t,e,n){function r(t){for(var e=new Array(arguments.length),n=0,r=arguments.length;r>n;n++)e[n]=arguments[n];e=e.slice(1);var i=t.traceName,o=t.transaction;if(t.options.signatureFormatter&&(i=t.options.signatureFormatter.apply(this,[t.fn,e,t.options])),o){var a=o.startTrace(i,t.traceType,t.options);t.trace=a}else c.log("%c instrumentMethodBefore.error.transaction.missing","background-color: #ffff00",t);return{args:e}}function i(t,e){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])}function o(t){t.trace&&t.trace.end()}function a(t){var e=t.toString().replace(h,""),n=e.match(f);return 2===n.length?n[1].split(p):[]}function s(t,e){var n='var args = new Array(arguments.length)\nfor (var i = 0, l = arguments.length; i < l; i++) {\n  args[i] = arguments[i]\n}\n// Before callback\nif (typeof _opbeatBefore === "function") {\nvar beforeData = _opbeatBefore.apply(this, [_opbeatContext].concat(args))\nif (beforeData.args) {\n args = beforeData.args\n}\n}\n// Execute original function\nvar result = _opbeatOriginalFunction.apply(this, args)\n// After callback\nif (typeof _opbeatAfter === "function") {\n  // After + Promise handling\n  if (result && typeof result.then === "function") {\n    result.finally(function () {\n      _opbeatAfter.apply(this, [_opbeatContext].concat(args))\n    }.bind(this))\n  } else {\n    _opbeatAfter.apply(this, [_opbeatContext].concat(args))\n  }\n}\nreturn result\n',r=[];for(var i in t){var o="var "+i+' = ctx["'+i+'"];';r.push(o)}var a="return function opbeatFunctionWrapper("+e+"){ "+n+" }";r.push(a);var s=new Function("ctx",r.join("\n"));return s(t)}var c=t("../lib/logger"),u=t("../lib/config"),l=t("./transactionStore"),f=/^function\s*[^\(]*\(\s*([^\)]*)\)/m,p=/,/,h=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm;e.exports={wrapMethod:function(t,e,n,r){var i=a(t).join(","),o={_opbeatOriginalFunction:t,_opbeatBefore:e,_opbeatAfter:n,_opbeatContext:r};return s(o,i)},instrumentMethodWithCallback:function(t,e,n,i,a){a=a||{};var s=[];if(!u.get("isInstalled"))return c.log("opbeat.instrumentation.instrumentMethodWithCallback.not.installed"),t;if(a.prefix){if("function"==typeof a.prefix){var l=a.wrapper?a.wrapper.args:[];a.prefix=a.prefix.call(this,l)}s.push(a.prefix)}e&&s.push(e),n||!a.traceBuffer||a.traceBuffer.isLocked()||(n=a.traceBuffer);var f=s.join("."),p=t,h={traceName:f,traceType:i,options:a,fn:t,transaction:n},g=this.wrapMethod(p,function(t){var e=Array.prototype.slice.call(arguments).slice(1),n=e[a.callbackIndex],i=this.wrapMethod(n,function(){return o.apply(this,[t]),{}},null);return e[t.options.callbackIndex]=i,r.apply(this,[t].concat(e))}.bind(this),null,h);return g.original=p,g},instrumentMethod:function(t,e,n,a,s){s=s||{};var l,f=[];if(s.prefix){if("function"==typeof s.prefix){var p=s.wrapper?s.wrapper.args:[];s.prefix=s.prefix.call(this,p)}f.push(s.prefix)}e&&f.push(e);var h=f.join(".");if(n||!s.traceBuffer||s.traceBuffer.isLocked()||(n=s.traceBuffer),l=s.instrumentModule?t:t[e],!u.get("isInstalled"))return c.log("opbeat.instrumentation.instrumentMethod.not.installed"),l;var g;g="function"==typeof a?a.call(s):a;var d={traceName:h,traceType:g,options:s,fn:e,transaction:n},m=this.wrapMethod(l,r,o,d);return m.original=l,i(m.original,m),s.override&&(t[e]=m),m},instrumentModule:function(t,e,n){var r=this,o=function(){var i=Array.prototype.slice.call(arguments),o=t.apply(this,i);return n.wrapper={args:i},r.instrumentObject(o,e,n),o};return i(t,o),this.instrumentObject(o,e,n),o},instrumentObject:function(t,e,n){if(n=n||{},!u.get("isInstalled"))return c.log("opbeat.instrumentation.instrumentObject.not.installed"),t;var r;if(n.transaction)r=n.transaction;else{var i=e.get("$location").absUrl();r=l.getRecentByUrl(i)}return r||!n.traceBuffer||n.traceBuffer.isLocked()||(r=n.traceBuffer),r?this.getObjectFunctions(t).forEach(function(e){n.override=!0,this.instrumentMethod(t,e.property,r,n.type,n)}.bind(this)):c.log("%c -- instrumentObject.error.transaction.missing","color: #d78f00"),t},uninstrumentMethod:function(t,e){var n=t[e];n.original&&(t[e]=n.original)},getObjectFunctions:function(t){return Object.keys(t).filter(function(e){return"function"==typeof t[e]}).map(function(e){var n=t[e];return{scope:t,property:e,ref:n}})},getControllerInfoFromArgs:function(t){var e,n;return"string"==typeof t[0]?n=t[0]:"function"==typeof t[0]&&(n=t[0].name,"opbeatFunctionWrapper"===n&&t[0].original&&(n=t[0].original.name)),"object"==typeof t[1]&&(e=t[1].$scope),{scope:e,name:n}},resolveAngularDependenciesByType:function(t,e){var n=t.attr("ng-app")||u.get("angularAppName");return n?window.angular.module(n)._invokeQueue.filter(function(t){return t[1]===e}).map(function(t){return t[2][0]}):[]}}},{"../lib/config":31,"../lib/logger":33,"./transactionStore":28}],30:[function(t,e,n){function r(t,e){this.q=[],this.opbeat=t,this.execute=this.execute.bind(this),this.push=this.push.bind(this),e&&e.forEach(function(t){this.push.apply(this,t)}.bind(this))}r.prototype.execute=function(t,e){return this.opbeat[t].apply(this.opbeat,e)},r.prototype.push=function(){var t=Array.prototype.slice.call(arguments),e=t.slice(0,1)[0],n=t.slice(1);this.execute(e,n)},e.exports=r},{}],31:[function(t,e,n){function r(){this.config={},this.defaults={VERSION:"v1.1.7",apiHost:"intake.opbeat.com",orgId:null,appId:null,angularAppName:null,performance:{enableStackFrames:!1},libraryPathPattern:"(node_modules|bower_components|webpack)",context:{user:{uuid:i()},extra:null}};var t=1===a.getRandomInt(0,10);t&&(this.defaults.performance.enableStackFrames=t)}function i(){var t="opbeat-uuid",e=s.get(t);return e||(e=a.generateUuid(),s.set(t,e)),e}function o(t){var e={},n=/^data\-([\w\-]+)$/;if(t)for(var r=t.attributes,i=0;i<r.length;i++){var o=r[i];if(n.test(o.nodeName)){var a=o.nodeName.match(n)[1];a=a.split("-").map(function(t,e){return e>0?t.charAt(0).toUpperCase()+t.substring(1):t}).join(""),e[a]=o.value||o.nodeValue}}return e}var a=t("./utils"),s=t("./storage");r.prototype.init=function(){var t=c();Object.keys(t).length&&this.setConfig(t)},r.prototype.get=function(t){return t.split(".").reduce(function(t,e){return t[e]},this.config)},r.prototype.set=function(t,e){var n=t.split("."),r=n.length-1,i=this.config;n.some(function(t,n){if("undefined"==typeof t)return!0;if(n===r)i[t]=e;else{var o=i[t]||{};i[t]=o,i=o}})},r.prototype.setConfig=function(t){t=t||{},this.config=a.mergeObject(this.defaults,t)},r.prototype.isValid=function(){var t=["appId","orgId"],e=t.map(function(t){return null===this.config[t]||void 0===this.config[t]}.bind(this));return-1===e.indexOf(!0)};var c=function(){var t=a.getCurrentScript(),e=o(t);return e};e.exports=new r},{"./storage":34,"./utils":36}],32:[function(t,e,n){var r=t("es6-promise").Promise,i=t("simple-lru-cache"),o=t("./transport"),a=new i({maxSize:1e3}),s={},c=function(t){return new r(function(e,n){return s[t]?void s[t].push(e):(s[t]=[],void o.getFile(t).then(function(n){a.set(t,n),e(n),s[t]&&s[t].forEach(function(t){t()}),s[t]=null},function(e){s[t]=null,n(e)}))})},u=function(t,e){return new r(function(e,n){var r=a.get(t);r?e(r):n()})};e.exports={getFile:function(t){return new r(function(e,n){u(t).then(function(t){e(t)},function(){c(t).then(function(t){e(t)},n)})})}}},{"./transport":35,"es6-promise":3,"simple-lru-cache":5}],33:[function(t,e,n){var r=t("./config"),i=[];e.exports={getLogStack:function(){return i},log:function(t,e){for(var n=new Array(arguments.length),o=0,a=arguments.length;a>o;o++)n[o]=arguments[o];var s=r.get("debug")===!0||"true"===r.get("debug"),c=window.console;i.push({msg:t,data:n.slice(1)}),s&&c&&window.console.log.apply(window.console,n)}}},{"./config":31}],34:[function(t,e,n){e.exports={set:function(t,e){return window.localStorage.setItem(t,JSON.stringify(e)),e},get:function(t){var e=window.localStorage.getItem(t);if("string"==typeof e)try{return JSON.parse(e)}catch(n){return e||void 0}}}},{}],35:[function(t,e,n){function r(t,e){o.log("opbeat.transport.sendToOpbeat",e);var n="https://"+a.get("apiHost")+"/api/v1/organizations/"+a.get("orgId")+"/apps/"+a.get("appId")+"/client-side/"+t+"/",r={"X-Opbeat-Client":"opbeat-js/"+a.get("VERSION")};return i(n,"POST","JSON",e,r)}function i(t,e,n,r,i){return new s(function(a,s){var c=new window.XMLHttpRequest;if(c.open(e,t,!0),c.timeout=1e4,"JSON"===n&&c.setRequestHeader("Content-Type","application/json"),i)for(var u in i)i.hasOwnProperty(u)&&c.setRequestHeader(u.toLowerCase(),i[u]);c.onreadystatechange=function(e){if(4===c.readyState){var n=c.status;if(0===n||n>399&&600>n){var r=new Error(t+" HTTP status: "+n);r.xhr=c,s(r),o.log("opbeat.transport.makeRequest.error",r)}else a(c.responseText),o.log("opbeat.transport.makeRequest.success")}},c.onerror=function(t){s(t),o.log("opbeat.transport.makeRequest.error",t)},"JSON"===n&&(r=JSON.stringify(r)),c.send(r)})}var o=t("./logger"),a=t("./config"),s=t("es6-promise").Promise;e.exports={sendError:function(t){return r("errors",t)},sendTransaction:function(t){return r("transactions",t)},getFile:function(t){return i(t,"GET","",{})}}},{"./config":31,"./logger":33,"es6-promise":3}],36:[function(t,e,n){e.exports={getViewPortInfo:function(){var t=document.documentElement,e=document.getElementsByTagName("body")[0],n=window.innerWidth||t.clientWidth||e.clientWidth,r=window.innerHeight||t.clientHeight||e.clientHeight;return{width:n,height:r}},mergeObject:function(t,e){var n,r={};for(n in t)r[n]=t[n];for(n in e)r[n]=e[n];return r},getRandomInt:function(t,e){return Math.floor(Math.random()*(e-t+1))+t},isUndefined:function(t){return"undefined"==typeof t},isCORSSupported:function(){var t=new window.XMLHttpRequest;return"withCredentials"in t},getCurrentScript:function(){return document.currentScript||function(){var t=document.getElementsByTagName("script");return t[t.length-1]}()},generateUuid:function(){function t(t){var e=(Math.random().toString(16)+"000000000").substr(2,8);return t?"-"+e.substr(0,4)+"-"+e.substr(4,4):e}return t()+t(!0)+t(!0)+t()}}},{}],37:[function(t,e,n){function r(){this._instrumentation=new s,this._exceptions=new c,this._config=a,this._config.set("isInstalled",!1),a.init();var t=[];window._opbeat&&(t=window._opbeat.q),this.api=new u(this,t),window._opbeat=this.api.push,this.install()}var i=t("./lib/logger"),o=t("./lib/utils"),a=t("./lib/config"),s=t("./instrumentation"),c=t("./exceptions"),u=t("./lib/api");r.prototype.VERSION="v1.1.7",r.prototype.isPlatformSupport=function(){return"function"==typeof Array.prototype.forEach&&"function"==typeof JSON.stringify&&"function"==typeof Function.bind&&o.isCORSSupported()},r.prototype.config=function(t){return t&&a.setConfig(t),this.install(),this._config},r.prototype.install=function(){return this.isPlatformSupport()?a.isValid()?this._config.get("isInstalled")?(i.log("opbeat.install.already.installed"),this):(this._exceptions.install(),this._config.set("isInstalled",!0),this):(i.log("opbeat.install.config.invalid"),this):(i.log("opbeat.install.platform.unsupported"),this)},r.prototype.uninstall=function(){return this._exceptions.uninstall(),this.isInstalled=!1,this},r.prototype.captureException=function(t,e){if(!this._config.get("isInstalled"))throw new Error("Can't capture exception. Opbeat isn't intialized");if(!(t instanceof Error))throw new Error("Can't capture exception. Passed exception needs to be an instanceof Error");return this._exceptions.processError(t,e),this},r.prototype.setUserContext=function(t){return t.uuid=a.get("context.user.uuid"),a.set("context.user",t),this},r.prototype.setExtraContext=function(t){return a.set("context.extra",t),this},r.prototype.startTransaction=function(t,e,n){return this._instrumentation.startTransaction(t,e,n)},e.exports=new r},{"./exceptions":12,"./instrumentation":23,"./lib/api":30,"./lib/config":31,"./lib/logger":33,"./lib/utils":36}]},{},[9]);